<% if notice  %>
  <div class="alert alert-success animated slideInDown" role="alert">
    <%= notice %>
  </div>
<% elsif alert %>
  <div class="alert alert-danger animated slideInDown" role="alert">
    <%= alert %>
  </div>
<% end %>

<div class="row">
  <% if @today_events.count > 0 %>
    <% @today_events.each do |e| %>
    <div class="col">
      <div class="card ">
        <div class="card-body">
          <h5 class="card-title">
            <span class="badge badge-pill badge-primary">
              <%= fa_icon('tag')%> <%= e.subject.name %>
            </span>
            <span class="badge badge-pill badge-info">
              <%= fa_icon('cloud') %>  <%= e.si.trigram %></span></h5>
          <p class="card-text"><%= e.description %>.</p>
          <p class="card-text"><small class="text-muted"><%= fa_icon('user') %> <%= e.user.firstname %></small></p>
        </div>
      </div>
    </div>
    <% end %>
  <% end %>
</div>

<%= week_calendar do |date| %>
<%= date.day %>/<%= date.month %>
<% end %>

<h1>Vérifications récurrentes</h1>

<table class="table table-hover table-borderless">
  <thead>
    <tr>
      <th><%= fa_icon('cloud') %> S.I</th>
      <th><%= fa_icon('tag') %> Sujet</th>
      <th><%= fa_icon('clipboard') %> Description</th>
      <th><%= fa_icon('user') %> Attribué à</th>
    </tr>
  </thead>

  <tbody>
    <% @events_recurrent.each do |event| %>
      <tr>
        <td><%= event.si.name %></td>
        <td><%= event.subject.name %></td>
        <td><%= event.description %></td>
        <td><%= event.user.firstname %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<h1>Tous les événements</h1>

<table class="table table-hover table-borderless">
  <thead>
    <tr>
      <th><%= fa_icon('user') %> Agent</th>
      <th><%= fa_icon('cloud') %> S.I</th>
      <th><%= fa_icon('thermometer') %> Criticité</th>
      <th><%= fa_icon('') %> Catégorie</th>
      <th><%= fa_icon('tag') %> Sujet</th>
      <th><%= fa_icon('calendar') %> Date de début</th>
      <th><%= fa_icon('calendar') %> Date de fin</th>
      <th><%= fa_icon('clipboard') %> Description</th>
      <th><%= fa_icon('disable') %> Désactivé</th>
      <th><%= fa_icon('repeat') %> Récurrence</th>
      <th colspan="2"></th>
    </tr>
  </thead>

  <tbody>
    <% @events.each do |event| %>
      <tr>
        <td><%= event.user.firstname %></td>
        <td><%= event.si.name %></td>
        <td><%= event.priority.name %></td>
        <td><%= event.category.name %></td>
        <td><%= event.subject.name %></td>
        <td><%= event.start_date.strftime("%d/%m/%y - %H:%M") %></td>
        <td><%= event.end_date.strftime("%d/%m/%y - %H:%M") if event.end_date %></td>
        <td><%= event.description %></td>
        <td><% if event.disable %><%= fa_icon('check', class:"text-success") %><% else %><%= fa_icon('close', class:"text-danger") %><% end %></td>
        <td><% if event.recurrent %><%= fa_icon('check', class:"text-success") %><% else %><%= fa_icon('close', class:"text-danger") %><% end %></td>
        <td><%= link_to 'Modifier', edit_event_path(event) %></td>
        <td><%= link_to 'Détruire', event, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>
